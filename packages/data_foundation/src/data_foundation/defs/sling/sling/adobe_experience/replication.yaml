# Sling connection profile for Adobe Experience event data. These high-volume web
# and app hits drive marketing attribution models downstream.
# https://docs.slingdata.io/concepts/replication

name: adobe_experience->snowflake
# Hourly backfills accommodate late-arriving events from Adobe. Adjust the
# schedule/partition metadata as SLAs evolve.
env: {SLING_LOADED_AT_COLUMN: timestamp}
source: adobe_experience
target: snowflake
defaults: 
    mode: backfill
    object: '{stream_schema_upper}.{stream_table_upper}'
    primary_key: [mcvisid, hitid_high, hitid_low, post_visid_high, post_visid_low]
    update_key: date_time
    target_options:
        column_casing: snake
        add_new_columns: true
        adjust_column_type: true
    meta:
        dagster:
            partition: "monthly"
            partition_start_date: "2025-07-01"
            automation_condition: "on_schedule"
            automation_condition_config: {"cron_schedule":"@monthly", "cron_timezone":"utc"}
            freshness_check: {"deadline_cron": "0 6 1 * *"}
streams:
    # Each stream entry defines a table to be ingested, the defaults above will be 
    # applied unless otherwise specified in the stream.  Meta captures table-level
    # metadata that controls scheduling as well as tagging that Dagster surfaces in
    # the UI. Keep these tags in sync with data governance expectations.
    adobe_experience.web_hits:
    adobe_experience.app_hits: